{"error": null, "issues": [{"address": 293, "code": "msg.sender.call{value: amount}(\"\")", "contract": "SimpleBank", "description": "A call to a user-supplied address is executed.\nAn external message call to an address specified by the caller is executed. Note that the callee account might contain arbitrary code and could re-enter any function within this contract. Reentering the contract in an intermediate state may lead to unexpected behaviour. Make sure that no state modifications are executed after this call and/or reentrancy guards are in place.", "filename": "SimpleBank.sol", "function": "withdraw()", "lineno": 13, "max_gas_used": 62148, "min_gas_used": 7204, "severity": "Low", "sourceMap": ":::-", "swc-id": "107", "title": "External Call To User-Supplied Address", "tx_sequence": {"initialState": {"accounts": {"0xaffeaffeaffeaffeaffeaffeaffeaffeaffeaffe": {"balance": "0x0", "code": "", "nonce": 0, "storage": "{}"}, "0xdeadbeefdeadbeefdeadbeefdeadbeefdeadbeef": {"balance": "0x0", "code": "", "nonce": 0, "storage": "{}"}}}, "steps": [{"address": "", "calldata": "", "input": "0x608060405234801561001057600080fd5b5061045e806100206000396000f3fe6080604052600436106100345760003560e01c806327e235e3146100395780633ccfd60b14610076578063d0e30db01461008d575b600080fd5b34801561004557600080fd5b50610060600480360381019061005b9190610252565b610097565b60405161006d9190610319565b60405180910390f35b34801561008257600080fd5b5061008b6100af565b005b6100956101e6565b005b60006020528060005260406000206000915090505481565b60008060003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002054905060003373ffffffffffffffffffffffffffffffffffffffff1682604051610118906102e4565b60006040518083038185875af1925050503d8060008114610155576040519150601f19603f3d011682016040523d82523d6000602084013e61015a565b606091505b505090508061019e576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610195906102f9565b60405180910390fd5b60008060003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020819055505050565b346000803373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060008282546102349190610350565b92505081905550565b60008135905061024c81610411565b92915050565b60006020828403121561026457600080fd5b60006102728482850161023d565b91505092915050565b600061028860148361033f565b91507f4661696c656420746f2073656e642045746865720000000000000000000000006000830152602082019050919050565b60006102c8600083610334565b9150600082019050919050565b6102de816103d8565b82525050565b60006102ef826102bb565b9150819050919050565b600060208201905081810360008301526103128161027b565b9050919050565b600060208201905061032e60008301846102d5565b92915050565b600081905092915050565b600082825260208201905092915050565b600061035b826103d8565b9150610366836103d8565b9250827fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0382111561039b5761039a6103e2565b5b828201905092915050565b60006103b1826103b8565b9050919050565b600073ffffffffffffffffffffffffffffffffffffffff82169050919050565b6000819050919050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052601160045260246000fd5b61041a816103a6565b811461042557600080fd5b5056fea2646970667358221220156c77c0a3db8f93d71a7336d193b7ca7a60db9635c9de9f948cc3304455d55364736f6c63430008000033", "name": "unknown", "origin": "0xaffeaffeaffeaffeaffeaffeaffeaffeaffeaffe", "value": "0x0"}, {"address": "0x901d12ebe1b195e5aa8748e62bd7734ae19b51f", "calldata": "0x3ccfd60b", "input": "0x3ccfd60b", "name": "withdraw()", "origin": "0xdeadbeefdeadbeefdeadbeefdeadbeefdeadbeef", "resolved_input": null, "value": "0x0"}]}}, {"address": 293, "code": "msg.sender.call{value: amount}(\"\")", "contract": "SimpleBank", "description": "The value of the call is dependent on balance or storage write\nThis can lead to race conditions. An attacker may be able to run a transaction after our transaction which can change the value of the call", "filename": "SimpleBank.sol", "function": "withdraw()", "lineno": 13, "max_gas_used": 62148, "min_gas_used": 7204, "severity": "Medium", "sourceMap": ":::-", "swc-id": "114", "title": "Transaction Order Dependence", "tx_sequence": {"initialState": {"accounts": {"0xaffeaffeaffeaffeaffeaffeaffeaffeaffeaffe": {"balance": "0x0", "code": "", "nonce": 0, "storage": "{}"}, "0xdeadbeefdeadbeefdeadbeefdeadbeefdeadbeef": {"balance": "0x0", "code": "", "nonce": 0, "storage": "{}"}}}, "steps": [{"address": "", "calldata": "", "input": "0x608060405234801561001057600080fd5b5061045e806100206000396000f3fe6080604052600436106100345760003560e01c806327e235e3146100395780633ccfd60b14610076578063d0e30db01461008d575b600080fd5b34801561004557600080fd5b50610060600480360381019061005b9190610252565b610097565b60405161006d9190610319565b60405180910390f35b34801561008257600080fd5b5061008b6100af565b005b6100956101e6565b005b60006020528060005260406000206000915090505481565b60008060003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002054905060003373ffffffffffffffffffffffffffffffffffffffff1682604051610118906102e4565b60006040518083038185875af1925050503d8060008114610155576040519150601f19603f3d011682016040523d82523d6000602084013e61015a565b606091505b505090508061019e576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610195906102f9565b60405180910390fd5b60008060003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020819055505050565b346000803373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060008282546102349190610350565b92505081905550565b60008135905061024c81610411565b92915050565b60006020828403121561026457600080fd5b60006102728482850161023d565b91505092915050565b600061028860148361033f565b91507f4661696c656420746f2073656e642045746865720000000000000000000000006000830152602082019050919050565b60006102c8600083610334565b9150600082019050919050565b6102de816103d8565b82525050565b60006102ef826102bb565b9150819050919050565b600060208201905081810360008301526103128161027b565b9050919050565b600060208201905061032e60008301846102d5565b92915050565b600081905092915050565b600082825260208201905092915050565b600061035b826103d8565b9150610366836103d8565b9250827fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0382111561039b5761039a6103e2565b5b828201905092915050565b60006103b1826103b8565b9050919050565b600073ffffffffffffffffffffffffffffffffffffffff82169050919050565b6000819050919050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052601160045260246000fd5b61041a816103a6565b811461042557600080fd5b5056fea2646970667358221220156c77c0a3db8f93d71a7336d193b7ca7a60db9635c9de9f948cc3304455d55364736f6c63430008000033", "name": "unknown", "origin": "0xaffeaffeaffeaffeaffeaffeaffeaffeaffeaffe", "value": "0x0"}, {"address": "0x901d12ebe1b195e5aa8748e62bd7734ae19b51f", "calldata": "0x3ccfd60b", "input": "0x3ccfd60b", "name": "withdraw()", "origin": "0xdeadbeefdeadbeefdeadbeefdeadbeefdeadbeef", "resolved_input": null, "value": "0x0"}]}}, {"address": 481, "code": "balances[msg.sender] = 0", "contract": "SimpleBank", "description": "Write to persistent state following external call\nThe contract account state is accessed after an external call to a user defined address. To prevent reentrancy issues, consider accessing the state only before the call, especially if the callee is untrusted. Alternatively, a reentrancy lock can be used to prevent untrusted callees from re-entering the contract in an intermediate state.", "filename": "SimpleBank.sol", "function": "withdraw()", "lineno": 15, "max_gas_used": 62148, "min_gas_used": 7204, "severity": "Medium", "sourceMap": ":24", "swc-id": "107", "title": "State access after external call", "tx_sequence": {"initialState": {"accounts": {"0xaffeaffeaffeaffeaffeaffeaffeaffeaffeaffe": {"balance": "0x0", "code": "", "nonce": 0, "storage": "{}"}, "0xdeadbeefdeadbeefdeadbeefdeadbeefdeadbeef": {"balance": "0x0", "code": "", "nonce": 0, "storage": "{}"}}}, "steps": [{"address": "", "calldata": "", "input": "0x608060405234801561001057600080fd5b5061045e806100206000396000f3fe6080604052600436106100345760003560e01c806327e235e3146100395780633ccfd60b14610076578063d0e30db01461008d575b600080fd5b34801561004557600080fd5b50610060600480360381019061005b9190610252565b610097565b60405161006d9190610319565b60405180910390f35b34801561008257600080fd5b5061008b6100af565b005b6100956101e6565b005b60006020528060005260406000206000915090505481565b60008060003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002054905060003373ffffffffffffffffffffffffffffffffffffffff1682604051610118906102e4565b60006040518083038185875af1925050503d8060008114610155576040519150601f19603f3d011682016040523d82523d6000602084013e61015a565b606091505b505090508061019e576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610195906102f9565b60405180910390fd5b60008060003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020819055505050565b346000803373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060008282546102349190610350565b92505081905550565b60008135905061024c81610411565b92915050565b60006020828403121561026457600080fd5b60006102728482850161023d565b91505092915050565b600061028860148361033f565b91507f4661696c656420746f2073656e642045746865720000000000000000000000006000830152602082019050919050565b60006102c8600083610334565b9150600082019050919050565b6102de816103d8565b82525050565b60006102ef826102bb565b9150819050919050565b600060208201905081810360008301526103128161027b565b9050919050565b600060208201905061032e60008301846102d5565b92915050565b600081905092915050565b600082825260208201905092915050565b600061035b826103d8565b9150610366836103d8565b9250827fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0382111561039b5761039a6103e2565b5b828201905092915050565b60006103b1826103b8565b9050919050565b600073ffffffffffffffffffffffffffffffffffffffff82169050919050565b6000819050919050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052601160045260246000fd5b61041a816103a6565b811461042557600080fd5b5056fea2646970667358221220156c77c0a3db8f93d71a7336d193b7ca7a60db9635c9de9f948cc3304455d55364736f6c63430008000033", "name": "unknown", "origin": "0xaffeaffeaffeaffeaffeaffeaffeaffeaffeaffe", "value": "0x0"}, {"address": "0x901d12ebe1b195e5aa8748e62bd7734ae19b51f", "calldata": "0x3ccfd60b", "input": "0x3ccfd60b", "name": "withdraw()", "origin": "0xdeadbeefdeadbeefdeadbeefdeadbeefdeadbeef", "resolved_input": null, "value": "0x0"}]}}], "success": true}
